% Document formatting specifications
% Page geometry
\usepackage[a4paper,top=2.5cm,bottom=2.5cm,left=2.5cm,right=2.5cm]{geometry}

% Change "Chapter" to "Section"
\renewcommand{\chaptername}{Section}

% Headers and footers
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{1pt}
\renewcommand{\footrulewidth}{0.5pt}
\fancyhead[L]{\textcolor{headerblue}{\textbf{CMT216 Computer and Network Forensics}}}
\fancyhead[R]{\textcolor{headerblue}{21089522\_TechnicalReport}}
\fancyfoot[C]{\thepage}
\fancyfoot[L]{Forensic Analysis - Taurus Smith Case}

% Adjust section formatting with reduced spacing
\titleformat{\chapter}[display]
{\normalfont\Large\bfseries\color{darkblue}}{\chaptertitlename\ \thechapter}{10pt}{\LARGE} % Reduced font size and spacing
\titlespacing*{\chapter}{0pt}{20pt}{20pt} % Significantly reduced spacing (was 50pt/40pt)

\titleformat{\section}
{\normalfont\Large\bfseries\color{darkblue}}{\thesection}{1em}{}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}

\titleformat{\subsection}
{\normalfont\large\bfseries\color{maroon}}{\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries\color{forestgreen}}{\thesubsubsection}{1em}{}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% Set up caption style - fixed to avoid color inside key-value pair
\captionsetup{
  font=small,
  labelfont=bf,
  labelsep=period,
  justification=justified
}
% Apply color to captions separately
\DeclareCaptionFont{captioncolor}{\color{darkblue}}
\captionsetup{labelfont={bf,captioncolor}}

% Table formatting
\renewcommand{\arraystretch}{1.3}

% Adjust list spacing
\setlist{noitemsep, topsep=0pt, parsep=0pt, partopsep=0pt}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=darkblue,
    filecolor=maroon,
    urlcolor=forestgreen,
    citecolor=darkblue,
    pdftitle={Forensic Analysis of USB Flash Drive Image - Taurus Smith Case},
    pdfauthor={Iolo Evans Jones},
    pdfsubject={Digital Forensics Technical Report},
    pdfkeywords={forensics, digital evidence, USB drive analysis, steganography},
    pdfproducer={LaTeX},
    pdfcreator={pdfLaTeX},
    bookmarksnumbered=true
}

% Set up table of contents formatting
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}

% Add some space between paragraphs
\setlength{\parskip}{0.5em}
\setlength{\headheight}{15pt}

% Make document more forgiving of spacing issues
\sloppy

% Super simple TOC spacing reduction
\makeatletter
\renewcommand*\l@chapter[2]{%
  \ifnum \c@tocdepth >\m@ne
    \addpenalty{-\@highpenalty}%
    \vskip 0.2em \@plus\p@
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode \bfseries
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1\nobreak\hfil \nobreak\hb@xt@\@pnumwidth{\hss #2}\par
      \penalty\@highpenalty
    \endgroup
  \fi}
\makeatother

% Reduce spacing in list of tables
\makeatletter
\renewcommand*\l@table{\@dottedtocline{1}{1.5em}{2.3em}}
\makeatother